---
thumbnail: >-
  images/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16
title: '[.Net]使用Soa库+Abp搭建微服务项目框架（三）：项目改造'
excerpt: "为什么要独立成服务？以一个健康医疗系统为例， 这个系统包含了用户模块，问卷的发放与填写，图表显示，报表生成与查看，患者管理等功能，传统的架构如下：随着项目规模的增长，在开发过程中会发现如下问题：各模块之间耦合严重，比如：报表模块引用了问卷，用户，随访，患者管理等几乎所有模块，难以维护\t间接引用的情况过多，导致项目分层不明确，容易产生引用分歧，难以维护目前做的就是解耦各个模块之间的强关联状态，通过上一章提到的上下文边界划分方式，我们大致可以将系统的架构改造如下：通过调用者和实现者共"
tags:
  - .net
  - EFCore
  - 微服务
categories:
  - .NET
toc: true
recommend: 1
keywords: categories-java
uniqueId: '2022-01-15 10:14:00/[.Net]使用Soa库+Abp搭建微服务项目框架（三）：项目改造.html'
abbrlink: a30acbed
date: 2022-01-15 10:14:00
cover:
description:
---
<p><span data-cke-copybin-start="1"><span data-cke-copybin-start="1">​</span></span><span id="cke_bm_1977S">上一章我们说道，如果要使各模块之间解耦，使得各自独立成服务，首先要解除各个模块之间的引用关系。</span></p>
<p>还记得上一章我们的小项目吗&nbsp;？们回到之前的代码上来，当前的项目架构如下图：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="29" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/39cb1e1812044d16ab1aa0b479216f7f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="798" height="499" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/39cb1e1812044d16ab1aa0b479216f7f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F39cb1e1812044d16ab1aa0b479216f7f.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22798%22%2C%22height%22%3A%22499%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>这次的任务是将它改造成面向服务体系的架构，是构建微服务的第一步改造：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="28" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/59ceb13e440c4cbbbf0296bb7fae1c9d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="699" height="606" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/59ceb13e440c4cbbbf0296bb7fae1c9d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F59ceb13e440c4cbbbf0296bb7fae1c9d.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22699%22%2C%22height%22%3A%22606%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>&nbsp;</p>
<h3>一. 引入Soa库</h3>
<p>首先将Soa库的三个项目引入到基础设施层：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="27" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/9509ac9571f348699aabe14ca5a1b8c4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_17,color_FFFFFF,t_70,g_se,x_16" alt="" width="436" height="101" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/9509ac9571f348699aabe14ca5a1b8c4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_17,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F9509ac9571f348699aabe14ca5a1b8c4.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_17%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22436%22%2C%22height%22%3A%22101%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<h3>二. 建立抽象层</h3>
<ul>
<li>&nbsp;创建Interface文件夹，分别创建MatoProject.IService1、MatoProject.IService2 类库项目<span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="26" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/5499e33ef4974401b2ef8f6ff840dbcf.png" alt="" width="265" height="58" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/5499e33ef4974401b2ef8f6ff840dbcf.png" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F5499e33ef4974401b2ef8f6ff840dbcf.png%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22265%22%2C%22height%22%3A%2258%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></li>
<li>创建接口，继承于ISoaService，</li>
<li>配置接口方法成员的SoaService属性和接口的SoaServiceRoute属性<span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="25" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/9018b4464855489cae6161d685bfe5c1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_12,color_FFFFFF,t_70,g_se,x_16" alt="" width="309" height="139" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/9018b4464855489cae6161d685bfe5c1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_12,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F9018b4464855489cae6161d685bfe5c1.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_12%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22309%22%2C%22height%22%3A%22139%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​<span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="24" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/aea75d3a5c9b4b309623fd4b38e6d896.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_11,color_FFFFFF,t_70,g_se,x_16" alt="" width="304" height="143" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/aea75d3a5c9b4b309623fd4b38e6d896.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_11,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Faea75d3a5c9b4b309623fd4b38e6d896.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_11%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22304%22%2C%22height%22%3A%22143%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></span></span></span></li>
<li>在领域层引用抽象层，并在各Manager中实现这个接口定义的方法&nbsp;</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>三. 编写服务端Host代码</h3>
<ul>
<li>&nbsp;创建ServiceHost文件夹，分别创建MatoProject.Service1.Host、MatoProject.Service2.Host 控制台项目</li>
</ul>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="23" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/bfeca98ce0b84b28aa9c929b8002738c.png" alt="" width="287" height="63" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/bfeca98ce0b84b28aa9c929b8002738c.png" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fbfeca98ce0b84b28aa9c929b8002738c.png%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22287%22%2C%22height%22%3A%2263%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<ul>
<li>项目添加appsettings.json，并配置好数据库连接字符串，并将文件的属性-复制到输出目录设置为&ldquo;如果较新则复制&rdquo;</li>
<li>在程序入口点Program.cs 中编写服务启动代码：</li>
</ul>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="22" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/0a523f863f41414c9d1cf5f9091f8977.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="524" height="386" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/0a523f863f41414c9d1cf5f9091f8977.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F0a523f863f41414c9d1cf5f9091f8977.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22524%22%2C%22height%22%3A%22386%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​&nbsp;<span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="21" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/4f60cdc047764059971a6bb7e26a0caf.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="520" height="367" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/4f60cdc047764059971a6bb7e26a0caf.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F4f60cdc047764059971a6bb7e26a0caf.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22520%22%2C%22height%22%3A%22367%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></span></span></span></p>
<ul>
<li>两个控制台应用作为Abp的模块，需要添加一个模块类，并继承自AbpModule</li>
<li>重写PreInitialize方法并配置默认数据库配置名称</li>
</ul>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="20" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/fb89b886f9a44cb7a26e481bbc7ed42a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="562" height="163" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/fb89b886f9a44cb7a26e481bbc7ed42a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Ffb89b886f9a44cb7a26e481bbc7ed42a.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22562%22%2C%22height%22%3A%22163%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<ul>
<li>重写Initialize方法并配置好Ioc</li>
</ul>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="19" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/dc13601044a941d6a41783d2b8681863.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="553" height="173" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/dc13601044a941d6a41783d2b8681863.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fdc13601044a941d6a41783d2b8681863.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22553%22%2C%22height%22%3A%22173%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<h3>&nbsp;四. 编写客户端调用代码</h3>
<p>打开MatoProject.Web.Core项目中的MatoProjectWebCoreModule.cs，重写PostInitialize方法并配置好客户端相关配置<span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="18" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/0418d3822bcf44578e11021d00752d4e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="561" height="324" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/0418d3822bcf44578e11021d00752d4e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F0418d3822bcf44578e11021d00752d4e.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22561%22%2C%22height%22%3A%22324%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>&nbsp;解决方案属性，设置启动项目为三个Host</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="17" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/b4bdea202d894827af967548fad082b2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_18,color_FFFFFF,t_70,g_se,x_16" alt="" width="469" height="196" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/b4bdea202d894827af967548fad082b2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_18,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fb4bdea202d894827af967548fad082b2.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_18%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22469%22%2C%22height%22%3A%22196%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<h3>&nbsp;五. 编写服务层代码</h3>
<ul>
<li>回到服务层MainService.cs，添加两个接口声明</li>
</ul>
<p>&nbsp;<span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="16" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/fd7795343b8343baafd1d5403dc177c2.png" alt="" width="277" height="36" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/fd7795343b8343baafd1d5403dc177c2.png" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Ffd7795343b8343baafd1d5403dc177c2.png%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22277%22%2C%22height%22%3A%2236%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<ul>
<li>在构造函数中注入IServiceProxy对象，并分别调用GetService方法将两个服务实例化</li>
</ul>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="15" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/859413bdb5c14146bb4ee0771b7d1a3b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_18,color_FFFFFF,t_70,g_se,x_16" alt="" width="462" height="128" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/859413bdb5c14146bb4ee0771b7d1a3b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_18,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F859413bdb5c14146bb4ee0771b7d1a3b.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_18%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22462%22%2C%22height%22%3A%22128%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<ul>
<li>&nbsp;GetExtends方法不需要作额外的修改，依旧是</li>
</ul>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="14" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/fc5751f8c93b4f90bf8aff95fb08fc88.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="704" height="189" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/fc5751f8c93b4f90bf8aff95fb08fc88.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Ffc5751f8c93b4f90bf8aff95fb08fc88.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22704%22%2C%22height%22%3A%22189%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>&nbsp;至此，所有的准备工作就绪。</p>
<p>&nbsp;运行项目，打开swagger界面，调试请求GetExtends接口，发现type和num值已经正确地显示</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="13" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/148960c879b64b8bbce62ce8da436cff.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="871" height="370" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/148960c879b64b8bbce62ce8da436cff.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F148960c879b64b8bbce62ce8da436cff.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZHJvaWRzYW5zZmFsbGJhY2s%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22871%22%2C%22height%22%3A%22370%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2020.cnblogs.com/blog/644861/202201/644861-20220115101341301-203909508.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<h3>项目地址</h3>
<p><a title="MatoApps/Soa (github.com)" href="https://github.com/MatoApps/Soa">MatoApps/Soa (github.com)</a></p>