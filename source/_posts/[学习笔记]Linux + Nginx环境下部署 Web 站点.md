---
thumbnail: images/7d9a1b3a27974b139628dd3e1ba1ffe9.png
title: '[学习笔记]Linux + Nginx环境下部署 Web 站点'
excerpt: >-
  首先更改server区域内容，root为你的站点根目录，注意不要指定任何index入口，因为这是目录。出现“blockedbyCORSpolicy”，未将网站域名添加至允许跨域访问设置。拷贝dist.zip到目标服务器的文件夹下，这里以~/下载为目标。若出现无法访问，网站报403或者404，请查看nginx日志。等待打包结束，成功后将在根目录下生成dist文件夹。部分错误可参照Troubleshooting解决。将站点文件移动至/var/www/{站点名称}/.........
tags:
  - [Linux]
  - Nginx
categories:
  - [Linux]
  - [Web]
toc: true
recommend: 1
keywords: categories-java
uniqueId: '2022-07-21 19:58:00/[学习笔记]Linux + Nginx环境下部署 Web 站点.html'
abbrlink: e233c37c
date: 2022-07-21 19:58:00
cover:
description:
---
<span data-cke-copybin-start="1"><span data-cke-copybin-start="1">​</span></span><span id="cke_bm_259S">部署后端程序，请阅读：</span><p><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="14" data-cke-widget-wrapper="1"><a href="https://www.cnblogs.com/jevonsflash/p/15879010.html">[学习笔记]Linux环境下部署 .Net5 程序 - 林晓lx - 博客园 (cnblogs.com)</a><a class="cke_widget_editable cke_widget_element" data-cke-enter-mode="2" data-cke-saved-href="https://blog.csdn.net/jevonsflash/article/details/122827930" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fblog.csdn.net%2Fjevonsflash%2Farticle%2Fdetails%2F122827930%22%2C%22text%22%3A%22%5B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%5DLinux%E7%8E%AF%E5%A2%83%E4%B8%8B%E9%83%A8%E7%BD%B2%20.Net5%20%E7%A8%8B%E5%BA%8F_%E6%9E%97%E6%99%93lx%E7%9A%84%E5%8D%9A%E5%AE%A2%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.1.7%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM666%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.1.7%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM666%22%2C%22id%22%3A%22ghgvyl-1658404533667%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.1.7/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M666" data-link-title="[学习笔记]Linux环境下部署 .Net5 程序_林晓lx的博客" data-widget="csdnlink" href="https://blog.csdn.net/jevonsflash/article/details/122827930" title="[学习笔记]Linux环境下部署 .Net5 程序_林晓lx的博客"><br/></a></span></p><h2>打包项目</h2><p>以Vue项目为例，首先打包站点，前往项目的根目录并键入：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="13" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22bash%22%2C%22code%22%3A%22yarn%20build%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-bash hljs">yarn build</code></pre>
</div><p> 等待打包结束，成功后将在根目录下生成dist文件夹</p><p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="12" data-cke-widget-wrapper="1"><img alt="" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/e8068e1f9f6f4b398c65f51dcd911603.png" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fe8068e1f9f6f4b398c65f51dcd911603.png%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22801%22%2C%22height%22%3A%22104%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" height="104" src="e8068e1f9f6f4b398c65f51dcd911603.png" width="801"/></span></p><p> 用Zip压缩dist文件夹至dist.zip</p><p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="11" data-cke-widget-wrapper="1"><img alt="" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/7d9a1b3a27974b139628dd3e1ba1ffe9.png" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F7d9a1b3a27974b139628dd3e1ba1ffe9.png%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22463%22%2C%22height%22%3A%22279%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" height="279" src="7d9a1b3a27974b139628dd3e1ba1ffe9.png" width="463"/></span></p><p>拷贝dist.zip到目标服务器的文件夹下，这里以 ~/下载 为目标</p><p>将站点文件移动至/var/www/{站点名称}/</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="10" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22bash%22%2C%22code%22%3A%22unzip%20~%2F%E4%B8%8B%E8%BD%BD%2Fdist.zip%20-d%20%2Fvar%2Fwww%2F%7B%E7%AB%99%E7%82%B9%E5%90%8D%E7%A7%B0%7D%2F%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-bash hljs">unzip ~/下载/dist.zip -d /var/www/{站点名称}/</code></pre>
</div><p> 配置权限</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="9" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22bash%22%2C%22code%22%3A%22sudo%20chmod%20777%20-R%20%2Fvar%2Fwww%2Fabp-mp-auth%2F%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-bash hljs">sudo <span class="hljs-built_in">chmod 777 -R /var/www/abp-mp-auth/</span></code></pre>
</div><p>配置防火墙和SELunix规则：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="8" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22bash%22%2C%22code%22%3A%22sudo%20firewall-cmd%20--zone%3Dpublic%20--add-port%3D8080%2Ftcp%20--permanent%5Cnsudo%20firewall-cmd%20--reload%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-bash hljs">sudo firewall-cmd --zone=public --add-port=8080/tcp --permanent
sudo firewall-cmd --reload</code></pre>
</div><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="7" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22bash%22%2C%22code%22%3A%22%20sudo%20semanage%20port%20-a%20-t%20http_port_t%20%20-p%20tcp%208080%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-bash hljs"> sudo semanage port -a -t http_port_t  -p tcp 8080</code></pre>
</div><h2> 配置Nginx</h2><p>首先更改server区域内容，root为你的站点根目录，注意不要指定任何index入口，因为这是目录</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="6" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22%20server%20%7B%5Cn%20%20%20%20listen%20%20%20%20%20%20%20%208080%20ssl%20http2%3B%5Cn%20%20%20%20server_name%20%20%20www.matoapp.net%3B%5Cn%20%20%20%20root%20%20%20%20%20%20%20%20%20%20%2Fvar%2Fwww%2F%7B%E7%AB%99%E7%82%B9%E5%90%8D%E7%A7%B0%7D%3B%5Cn%20%7D%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs"> server {
    listen        8080 ssl http2;
    server_name   www.matoapp.net;
    root          /var/www/{站点名称};
 }</code></pre>
</div><p>Nginx配置SSL证书，请阅读：</p><p><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="5" data-cke-widget-wrapper="1"><a href="https://www.cnblogs.com/jevonsflash/p/15880802.html">[学习笔记] Linux 环境下搭建基于Ngnix的反向代理服务 - 林晓lx - 博客园 (cnblogs.com)</a><a class="cke_widget_editable cke_widget_element" data-cke-enter-mode="2" data-cke-saved-href="https://blog.csdn.net/jevonsflash/article/details/122867847" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fblog.csdn.net%2Fjevonsflash%2Farticle%2Fdetails%2F122867847%22%2C%22text%22%3A%22%5B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%5D%20Linux%20%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8ENgnix%E7%9A%84%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1_%E6%9E%97%E6%99%93lx%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.1.7%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM666%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.1.7%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM666%22%2C%22id%22%3A%22zWUmiA-1658404533662%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.1.7/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M666" data-link-title="[学习笔记] Linux 环境下搭建基于Ngnix的反向代理服务_林晓lx的博客-CSDN博客" data-widget="csdnlink" href="https://blog.csdn.net/jevonsflash/article/details/122867847" title="[学习笔记] Linux 环境下搭建基于Ngnix的反向代理服务_林晓lx的博客-CSDN博客"><br/></a></span></p><p>若出现无法访问，网站报403或者404，请查看nginx日志</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="4" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22bash%22%2C%22code%22%3A%22sudo%20cat%20%2Fvar%2Flog%2Fnginx%2Ferror.log%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-bash hljs">sudo <span class="hljs-built_in">cat /var/log/nginx/error.log</span></code></pre>
</div><p>部分错误可参照 Troubleshooting解决</p><h2>Troubleshooting</h2><p>若在日志显示：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="3" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22%5C%22%2Fhome%2Fxamarin%2Fweb%2F%7B%E7%AB%99%E7%82%B9%E5%90%8D%E7%A7%B0%7D%2Findex.html%5C%22%20is%20forbidden%20(13%3A%20Permission%20denied)%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">"/home/xamarin/web/{站点名称}/index.html" is forbidden (13: Permission denied)</code></pre>
</div><p>则有可能是SELinux策略问题，键入下列命令添加规则，建议不要直接禁用SELinux：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="2" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22bash%22%2C%22code%22%3A%22chcon%20-R%20-t%20httpd_sys_content_t%20%2Fvar%2Fwww%2F%7B%E7%AB%99%E7%82%B9%E5%90%8D%E7%A7%B0%7D%2Fdist%2F%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-bash hljs"><span class="hljs-built_in">chcon -R -t httpd_sys_content_t /var/www/{站点名称}/dist/</span></code></pre>
</div><p>出现“blocked by CORS policy”， 未将网站域名添加至允许跨域访问设置</p><p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="1" data-cke-widget-wrapper="1"><img alt="" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/d92916d26f804e0a8d185f6802fd36fa.png" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fd92916d26f804e0a8d185f6802fd36fa.png%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22676%22%2C%22height%22%3A%2262%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" height="62" src="d92916d26f804e0a8d185f6802fd36fa.png" width="676"/></span></p><p> 在服务端config中，或者docker run命令参数中，添加站点地址至允许跨域访问设置：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="0" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22bash%22%2C%22code%22%3A%22docker%20run%20-p%2044311%3A44311%20--net%3D%5C%22host%5C%22%20-e%20App%3ACorsOrigins%3D%5C%22https%3A%2F%2F%7B%E7%AB%99%E7%82%B9%E5%9C%B0%E5%9D%80%7D%3A8080%5C%22%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-bash hljs">docker run -p 44311:44311 --net=<span class="hljs-string">"host" -e App:CorsOrigins=<span class="hljs-string">"https://{站点地址}:8080"</span></span></code></pre>
</div><p><br/>
</p><span data-cke-copybin-start="1">
<span data-cke-copybin-end="1">​</span></span>