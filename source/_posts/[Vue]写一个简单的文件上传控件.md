---
thumbnail: images/95937c7177a349b091fa81d3a0df8376.png
title: '[Vue]写一个简单的文件上传控件'
excerpt: >-
  这篇将介绍如何写一个简单的基于Vue+Element的文件上传控件。控件将具有1. 上传队列的列表，显示文件名称，大小等信息，可以显示上传进度实时刷新2.
  取消上传使用Element的uploader控件，上传文件的行为和样式不用自己全部实现，使代码简化。且有足够的扩展性，文件传输请求的代码可以基于axios完全自己重写。我们只用关心核心代码。搭建项目框架首先建立一个空白的项目，引入Element控件库，具体的操作和使用Element控件库请看官方文档：组件
  | ..
tags:
  - Vue
  - ElementUI
categories:
  - [Web]
toc: true
recommend: 1
keywords: categories-java
uniqueId: '2022-04-20 15:10:00/[Vue]写一个简单的文件上传控件.html'
abbrlink: 4f544a9a
date: 2022-04-20 15:10:00
cover:
description:
---
<span data-cke-copybin-start="1"><span data-cke-copybin-start="1">​</span></span><span id="cke_bm_382S">这篇将介绍如何写一个简单的基于Vue+Element的文件上传控件。</span><p>控件将具有</p><p>1. 上传队列的列表，显示文件名称，大小等信息，可以显示上传进度实时刷新</p><p>2. 取消上传</p><p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="15" data-cke-widget-wrapper="1"><img alt="" class="cke_widget_element" data-cke-saved-src="https://img2023.cnblogs.com/blog/644861/202310/644861-20231022164733049-398335789.png" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fe1a5a508d1d241f7a0dee9cf6333b248.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6XIOWwjw%3D%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22538%22%2C%22height%22%3A%22116%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" height="116" src="644861-20231022164733049-398335789.png" width="538"/></span></p><p> 使用Element的uploader控件，上传文件的行为和样式不用自己全部实现，使代码简化。且有足够的扩展性，文件传输请求的代码可以基于axios完全自己重写。我们只用关心核心代码。</p><h2>搭建项目框架</h2><p>首先建立一个空白的项目，引入Element控件库，具体的操作和使用Element控件库请看官方文档：</p><p><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="14" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" data-cke-enter-mode="2" data-cke-saved-href="https://element.eleme.cn/#/zh-CN/component/quickstart" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Felement.eleme.cn%2F%23%2Fzh-CN%2Fcomponent%2Fquickstart%22%2C%22text%22%3A%22%E7%BB%84%E4%BB%B6%20%7C%20Element%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM276%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.9%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM3C8%22%2C%22id%22%3A%22XXNnT2-1650438341156%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.0.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M276" data-link-title="组件 | Element" data-widget="csdnlink" href="https://element.eleme.cn/#/zh-CN/component/quickstart" title="组件 | Element">组件 | Element</a></span></p><p>后端项目框架的搭建，请阅读：<a href="https://www.cnblogs.com/jevonsflash/p/16169976.html">[.Net 6]写一个简单的文件上传控件后端 - 林晓lx - 博客园 (cnblogs.com)</a><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="13" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" data-cke-enter-mode="2" data-cke-saved-href="https://blog.csdn.net/jevonsflash/article/details/124152645" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fblog.csdn.net%2Fjevonsflash%2Farticle%2Fdetails%2F124152645%22%2C%22text%22%3A%22%5B.Net%206%5D%E5%86%99%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%8E%A7%E4%BB%B6%E5%90%8E%E7%AB%AF_%E6%9E%97%20%E5%B0%8F%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM276%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.9%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM3C8%22%2C%22id%22%3A%22NCaJGh-1650438341155%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.0.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M276" data-link-title="[.Net 6]写一个简单的文件上传控件后端_林 小的博客-CSDN博客" data-widget="csdnlink" href="https://blog.csdn.net/jevonsflash/article/details/124152645" title="[.Net 6]写一个简单的文件上传控件后端_林 小的博客-CSDN博客"><br/></a></span></p><h2>编写文件上传代码</h2><p>编写文件上传的帮助类，新建ajaxRequire.ts并键入以下内容：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="12" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22import%20axios%2C%20%7B%20CancelTokenSource%20%7D%20from%20'axios'%5Cn%2F%2F%E5%8F%91%E9%80%81%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%5Cnexport%20const%20request%20%3D%20async%20(url%3A%20string%2C%20methods%2C%20data%3A%20any%2C%20onProgress%3F%3A%20(e)%3D%3Evoid%2C%20cancelToken%3F%3A%20CancelTokenSource)%20%3D%3E%20%7B%20%20%20%5Cn%20%20%20%20let%20token%20%3D%20null%5Cn%20%20%20%20let%20timeout%20%3D%203000%3B%5Cn%20%20%20%20if%20(cancelToken)%20%7B%5Cn%20%20%20%20%20%20%20%20token%20%3D%20cancelToken.token%5Cn%20%20%20%20%20%20%20%20timeout%20%3D%200%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20const%20service%20%3D%20axios.create()%5Cn%20%20%20%20const%20re%20%3D%20await%20service.request(%7B%5Cn%20%20%20%20%20%20%20%20headers%3A%20%7B'Content-Type'%3A%20'multipart%2Fform-data'%7D%2C%5Cn%20%20%20%20%20%20%20%20url%3A%20url%2C%5Cn%20%20%20%20%20%20%20%20method%3A%20methods%2C%5Cn%20%20%20%20%20%20%20%20data%3A%20data%2C%5Cn%20%20%20%20%20%20%20%20cancelToken%3A%20token%2C%5Cn%20%20%20%20%20%20%20%20timeout%3A%20timeout%2C%5Cn%20%20%20%20%20%20%20%20onUploadProgress%3A%20function%20(progressEvent)%20%7B%20%2F%2F%E5%8E%9F%E7%94%9F%E8%8E%B7%E5%8F%96%E4%B8%8A%E4%BC%A0%E8%BF%9B%E5%BA%A6%E7%9A%84%E4%BA%8B%E4%BB%B6%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20(progressEvent.lengthComputable)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(onProgress)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20onProgress(progressEvent)%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%2C%5Cn%20%20%20%20%7D)%5Cn%20%20%20%20return%20re%20as%20any%3B%5Cn%7D%5Cn%5Cn%2F%2F%2F%E8%8E%B7%E5%BE%97%E5%8F%96%E6%B6%88%E4%BB%A4%E7%89%8C%5Cnexport%20const%20getCancelToken%20%3D%20()%20%3D%3E%20%7B%5Cn%20%20%20%20const%20source%20%3D%20axios.CancelToken.source()%3B%5Cn%20%20%20%20return%20source%3B%5Cn%7D%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-TypeScript hljs"><span class="hljs-keyword">import axios, { <span class="hljs-title class_">CancelTokenSource } <span class="hljs-keyword">from <span class="hljs-string">'axios'
<span class="hljs-comment">//发送网络请求
<span class="hljs-keyword">export <span class="hljs-keyword">const request = <span class="hljs-keyword">async (<span class="hljs-attr">url: <span class="hljs-built_in">string, methods, <span class="hljs-attr">data: <span class="hljs-built_in">any, onProgress?: <span class="hljs-function">(<span class="hljs-params">e)=&gt;<span class="hljs-built_in">void, cancelToken?: <span class="hljs-title class_">CancelTokenSource) =&gt; {   
    <span class="hljs-keyword">let token = <span class="hljs-literal">null
    <span class="hljs-keyword">let timeout = <span class="hljs-number">3000;
    <span class="hljs-keyword">if (cancelToken) {
        token = cancelToken.<span class="hljs-property">token
        timeout = <span class="hljs-number">0;
    }
    <span class="hljs-keyword">const service = axios.<span class="hljs-title function_">create()
    <span class="hljs-keyword">const re = <span class="hljs-keyword">await service.<span class="hljs-title function_">request({
        <span class="hljs-attr">headers: {<span class="hljs-string">'Content-Type': <span class="hljs-string">'multipart/form-data'},
        <span class="hljs-attr">url: url,
        <span class="hljs-attr">method: methods,
        <span class="hljs-attr">data: data,
        <span class="hljs-attr">cancelToken: token,
        <span class="hljs-attr">timeout: timeout,
        <span class="hljs-attr">onUploadProgress: <span class="hljs-keyword">function (<span class="hljs-params">progressEvent) { <span class="hljs-comment">//原生获取上传进度的事件
            <span class="hljs-keyword">if (progressEvent.<span class="hljs-property">lengthComputable) {
                <span class="hljs-keyword">if (onProgress) {
                    <span class="hljs-title function_">onProgress(progressEvent);
                }
            }
        },
    })
    <span class="hljs-keyword">return re <span class="hljs-keyword">as <span class="hljs-built_in">any;
}

<span class="hljs-comment">///获得取消令牌
<span class="hljs-keyword">export <span class="hljs-keyword">const <span class="hljs-title function_">getCancelToken = () =&gt; {
    <span class="hljs-keyword">const source = axios.<span class="hljs-property">CancelToken.<span class="hljs-title function_">source();
    <span class="hljs-keyword">return source;
}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
</div><p>onUploadProgress回调函数将在数据传输进度变化的时候触发，携带progressEvent 原生获取上传进度事件参数，progressEvent.lengthComputable用于判断是否可以进行进度计算</p><p>axios.CancelToken.source()可以获得一个源，这个源包含一个唯一Id用于标识哪个请求，和一个cancel函数用于取消请求</p><h2><strong>编写控件</strong></h2><p>在App.vue中添加核心的控件 <strong> &lt;el-upload&gt;</strong></p><p>接着添加属性，注意我们将用自己的方法upload替换el-upload中的上传操作，因此设置action="/",</p><p>:http-request="upload",如下：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="11" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22html%22%2C%22code%22%3A%22%3Cel-upload%5Cn%20%20%20%20%20%20ref%3D%5C%22upload%5C%22%5Cn%20%20%20%20%20%20%3Alimit%3D%5C%2210%5C%22%5Cn%20%20%20%20%20%20multiple%5Cn%20%20%20%20%20%20action%3D%5C%22%2F%5C%22%5Cn%20%20%20%20%20%20%3Ahttp-request%3D%5C%22upload%5C%22%3E%5Cn%3C%2Fel-upload%3E%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-html hljs"><span class="hljs-tag">&lt;<span class="hljs-name">el-upload
      <span class="hljs-attr">ref=<span class="hljs-string">"upload"
      <span class="hljs-attr">:limit=<span class="hljs-string">"10"
      <span class="hljs-attr">multiple
      <span class="hljs-attr">action=<span class="hljs-string">"/"
      <span class="hljs-attr">:http-request=<span class="hljs-string">"upload"&gt;
<span class="hljs-tag">&lt;/<span class="hljs-name">el-upload&gt;</span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
</div><p>在script中添加上传Dto：一些业务相关的数据在这里定义 比如ownerUserId， fileContainerName等，这些数据可以通过表单与文件数据一并上传</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="10" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22export%20class%20CreateFileDto%20%7B%5Cn%20%20id%3A%20string%3B%5Cn%20%20fileContainerName%3A%20string%3B%20%2F%2F%E6%96%87%E4%BB%B6%E5%A4%B9%E5%90%8D%E7%A7%B0%5Cn%20%20parentId%3A%20string%3B%20%20%20%20%20%20%20%20%20%20%2F%2F%E6%96%87%E4%BB%B6%E7%9A%84%E7%88%B6Id%5Cn%20%20ownerUserId%3A%20number%3B%20%20%20%20%20%20%20%20%2F%2F%E6%96%87%E4%BB%B6%E7%9A%84%E5%BD%92%E5%B1%9E%E7%94%A8%E6%88%B7Id%5Cn%20%20fileName%3A%20string%3B%5Cn%20%20mimeType%3A%20string%3B%5Cn%20%20fileType%3A%20number%3B%20%2F%2F%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%200%EF%BC%9A%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C1%EF%BC%9A%E6%99%AE%E9%80%9A%E6%96%87%E4%BB%B6%5Cn%20%20file%3A%20any%3B%20%20%20%20%20%20%20%20%2F%2F%E6%96%87%E4%BB%B6%E6%95%B0%E6%8D%AE%5Cn%7D%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-TypeScript hljs"><span class="hljs-keyword">export <span class="hljs-keyword">class <span class="hljs-title class_">CreateFileDto {
  <span class="hljs-attr">id: <span class="hljs-built_in">string;
  <span class="hljs-attr">fileContainerName: <span class="hljs-built_in">string; <span class="hljs-comment">//文件夹名称
  <span class="hljs-attr">parentId: <span class="hljs-built_in">string;          <span class="hljs-comment">//文件的父Id
  <span class="hljs-attr">ownerUserId: <span class="hljs-built_in">number;        <span class="hljs-comment">//文件的归属用户Id
  <span class="hljs-attr">fileName: <span class="hljs-built_in">string;
  <span class="hljs-attr">mimeType: <span class="hljs-built_in">string;
  <span class="hljs-attr">fileType: <span class="hljs-built_in">number; <span class="hljs-comment">//文件类型 0：文件夹，1：普通文件
  <span class="hljs-attr">file: <span class="hljs-built_in">any;        <span class="hljs-comment">//文件数据
}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
</div><p>method中添加一些帮助类函数：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="9" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22methods%3A%20%7B%5Cn%20%20successMessage(value%20%3D%20%5C%22%E6%89%A7%E8%A1%8C%E6%88%90%E5%8A%9F%5C%22)%20%7B%5Cn%20%20%20%20%20%20this.%24notify(%7B%5Cn%20%20%20%20%20%20%20%20title%3A%20%5C%22%E6%88%90%E5%8A%9F%5C%22%2C%5Cn%20%20%20%20%20%20%20%20message%3A%20value%2C%5Cn%20%20%20%20%20%20%20%20type%3A%20%5C%22success%5C%22%2C%5Cn%20%20%20%20%20%20%7D)%3B%5Cn%20%20%20%20%7D%2C%5Cn%5Cn%20%20errorMessage(value%20%3D%20%5C%22%E6%89%A7%E8%A1%8C%E9%94%99%E8%AF%AF%5C%22)%20%7B%5Cn%20%20%20%20%20%20this.%24notify.error(%7B%5Cn%20%20%20%20%20%20%20%20title%3A%20%5C%22%E9%94%99%E8%AF%AF%5C%22%2C%5Cn%20%20%20%20%20%20%20%20message%3A%20value%2C%5Cn%20%20%20%20%20%20%7D)%3B%5Cn%20%20%20%20%7D%2C%5Cn%5Cn%20%20FriendlyFileSize(bytes)%20%7B%5Cn%20%20%20%20%20%20bytes%20%3D%20parseFloat(bytes)%3B%5Cn%20%20%20%20%20%20if%20(bytes%20%3D%3D%3D%200)%20return%20%5C%220B%5C%22%3B%5Cn%20%20%20%20%20%20let%20k%20%3D%201024%2C%5Cn%20%20%20%20%20%20%20%20sizes%20%3D%20%5B%5C%22B%5C%22%2C%20%5C%22KB%5C%22%2C%20%5C%22MB%5C%22%2C%20%5C%22GB%5C%22%2C%20%5C%22TB%5C%22%5D%2C%5Cn%20%20%20%20%20%20%20%20i%20%3D%20Math.floor(Math.log(bytes)%20%2F%20Math.log(k))%3B%5Cn%20%20%20%20%20%20return%20(bytes%20%2F%20Math.pow(k%2C%20i)).toPrecision(3)%20%2B%20sizes%5Bi%5D%3B%5Cn%20%20%20%20%7D%2C%5Cn%7D%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-TypeScript hljs"><span class="hljs-attr">methods: {
  <span class="hljs-title function_">successMessage(<span class="hljs-params">value = <span class="hljs-string">"执行成功") {
      <span class="hljs-variable language_">this.$notify({
        <span class="hljs-attr">title: <span class="hljs-string">"成功",
        <span class="hljs-attr">message: value,
        <span class="hljs-attr">type: <span class="hljs-string">"success",
      });
    },

  <span class="hljs-title function_">errorMessage(<span class="hljs-params">value = <span class="hljs-string">"执行错误") {
      <span class="hljs-variable language_">this.<span class="hljs-property">$notify.<span class="hljs-title function_">error({
        <span class="hljs-attr">title: <span class="hljs-string">"错误",
        <span class="hljs-attr">message: value,
      });
    },

  <span class="hljs-title class_">FriendlyFileSize(bytes) {
      bytes = <span class="hljs-built_in">parseFloat(bytes);
      <span class="hljs-keyword">if (bytes === <span class="hljs-number">0) <span class="hljs-keyword">return <span class="hljs-string">"0B";
      <span class="hljs-keyword">let k = <span class="hljs-number">1024,
        sizes = [<span class="hljs-string">"B", <span class="hljs-string">"KB", <span class="hljs-string">"MB", <span class="hljs-string">"GB", <span class="hljs-string">"TB"],
        i = <span class="hljs-title class_">Math.<span class="hljs-title function_">floor(<span class="hljs-title class_">Math.<span class="hljs-title function_">log(bytes) / <span class="hljs-title class_">Math.<span class="hljs-title function_">log(k));
      <span class="hljs-keyword">return (bytes / <span class="hljs-title class_">Math.<span class="hljs-title function_">pow(k, i)).<span class="hljs-title function_">toPrecision(<span class="hljs-number">3) + sizes[i];
    },
}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
</div><p>编写提交前置函数，这里将做验证和生成cancelToken：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="8" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22beforeUpload(file)%20%7B%5Cn%20%20%20%20%20%20var%20token%20%3D%20getCancelToken()%3B%5Cn%20%20%20%20%20%20file.cancelToken%20%3D%20token%3B%5Cn%20%20%20%20%20%20let%20isLt2M%20%3D%20true%3B%5Cn%20%20%20%20%20%20if%20(this.fileSizeLimit%20%3C%200)%20%7B%5Cn%20%20%20%20%20%20%20%20return%20true%3B%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20isLt2M%20%3D%20file.size%20%2F%201024%20%2F%201024%20%3C%20this.fileSizeLimit%3B%5Cn%20%20%20%20%20%20if%20(!isLt2M)%20%7B%5Cn%20%20%20%20%20%20%20%20this.loading%20%3D%20false%3B%5Cn%20%20%20%20%20%20%20%20this.errorMessage(%60%5C%22%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E4%B8%8D%E8%83%BD%E8%B6%85%E8%BF%87%20%24%7Bthis.fileSizeLimit%7D%7DMB!%5C%22%60)%3B%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return%20isLt2M%3B%5Cn%7D%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-TypeScript hljs"><span class="hljs-title function_">beforeUpload(<span class="hljs-params">file) {
      <span class="hljs-keyword">var token = <span class="hljs-title function_">getCancelToken();
      file.<span class="hljs-property">cancelToken = token;
      <span class="hljs-keyword">let isLt2M = <span class="hljs-literal">true;
      <span class="hljs-keyword">if (<span class="hljs-variable language_">this.<span class="hljs-property">fileSizeLimit &lt; <span class="hljs-number">0) {
        <span class="hljs-keyword">return <span class="hljs-literal">true;
      }
      isLt2M = file.<span class="hljs-property">size / <span class="hljs-number">1024 / <span class="hljs-number">1024 &lt; <span class="hljs-variable language_">this.<span class="hljs-property">fileSizeLimit;
      <span class="hljs-keyword">if (!isLt2M) {
        <span class="hljs-variable language_">this.<span class="hljs-property">loading = <span class="hljs-literal">false;
        <span class="hljs-variable language_">this.<span class="hljs-title function_">errorMessage(<span class="hljs-string">`"上传文件大小不能超过 <span class="hljs-subst">${<span class="hljs-variable language_">this.fileSizeLimit}}MB!"`);
      }
      <span class="hljs-keyword">return isLt2M;
}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
</div><p> 编写upload函数，用于组装请求数据并交给 ajaxRequire 执行上传任务</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="7" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22%20%20async%20upload(option)%20%7B%5Cn%20%20%20%20%20%20this.loaded%20%3D%20true%3B%5Cn%20%20%20%20%20%20var%20model%20%3D%20new%20CreateFileDto()%3B%5Cn%20%20%20%20%20%20var%20file%20%3D%20option.file%3B%5Cn%20%20%20%20%20%20model.fileName%20%3D%20file.name%3B%5Cn%20%20%20%20%20%20model.fileType%20%3D%202%3B%5Cn%20%20%20%20%20%20model.mimeType%20%3D%20file.type%3B%5Cn%20%20%20%20%20%20model.ownerUserId%20%3D%201%3B%5Cn%20%20%20%20%20%20model.fileContainerName%20%3D%20%5C%22Container1%5C%22%3B%5Cn%20%20%20%20%20%20model.file%20%3D%20file%3B%5Cn%20%20%20%20%20%20var%20fd%20%3D%20new%20FormData()%3B%5Cn%5Cn%20%20%20%20%20%20Enumerable.from(model).forEach((c)%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20fd.append(c.key%2C%20c.value)%3B%5Cn%20%20%20%20%20%20%7D)%3B%5Cn%5Cn%20%20%20%20%20%20var%20token%20%3D%20file.cancelToken%3B%5Cn%20%20%20%20%20%20await%20request(%5Cn%20%20%20%20%20%20%20%20this.uploadUrl%2C%5Cn%20%20%20%20%20%20%20%20%5C%22post%5C%22%2C%5Cn%20%20%20%20%20%20%20%20fd%2C%5Cn%20%20%20%20%20%20%20%20(e)%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if%20(e.total%20%3E%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20e.percent%20%3D%20(e.loaded%20%2F%20e.total)%20*%20100%3B%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20option.onProgress(e)%3B%5Cn%20%20%20%20%20%20%20%20%7D%2C%5Cn%20%20%20%20%20%20%20%20token%5Cn%20%20%20%20%20%20)%3B%5Cn%20%20%20%20%7D%2C%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-TypeScript hljs">  <span class="hljs-keyword">async <span class="hljs-title function_">upload(<span class="hljs-params">option) {
      <span class="hljs-variable language_">this.<span class="hljs-property">loaded = <span class="hljs-literal">true;
      <span class="hljs-keyword">var model = <span class="hljs-keyword">new <span class="hljs-title class_">CreateFileDto();
      <span class="hljs-keyword">var file = option.<span class="hljs-property">file;
      model.<span class="hljs-property">fileName = file.<span class="hljs-property">name;
      model.<span class="hljs-property">fileType = <span class="hljs-number">2;
      model.<span class="hljs-property">mimeType = file.<span class="hljs-property">type;
      model.<span class="hljs-property">ownerUserId = <span class="hljs-number">1;
      model.<span class="hljs-property">fileContainerName = <span class="hljs-string">"Container1";
      model.<span class="hljs-property">file = file;
      <span class="hljs-keyword">var fd = <span class="hljs-keyword">new <span class="hljs-title class_">FormData();
      <span class="hljs-title class_">Enumerable.<span class="hljs-title function_">from(model).<span class="hljs-title function_">forEach(<span class="hljs-function">(<span class="hljs-params">c) =&gt; {
        fd.<span class="hljs-title function_">append(c.<span class="hljs-property">key, c.<span class="hljs-property">value);
      });
      <span class="hljs-keyword">var token = file.<span class="hljs-property">cancelToken;
      <span class="hljs-keyword">await <span class="hljs-title function_">request(
        <span class="hljs-variable language_">this.<span class="hljs-property">uploadUrl,
        <span class="hljs-string">"post",
        fd,
        <span class="hljs-function">(<span class="hljs-params">e) =&gt; {
          <span class="hljs-keyword">if (e.<span class="hljs-property">total &gt; <span class="hljs-number">0) {
            e.<span class="hljs-property">percent = (e.<span class="hljs-property">loaded / e.<span class="hljs-property">total) * <span class="hljs-number">100;
          }
          option.<span class="hljs-title function_">onProgress(e);
        },
        token
      );
    },</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
</div><p>将token将作为取消传输的入口交给ajaxRequire ，自己也保留这个对象用于发送取消命令，相当于“一式两份”。</p><p>添加el-upload各阶段函数的订阅</p><p>:before-upload="beforeUpload"<br/>
:on-success="handleSuccess"<br/>
:on-remove="handleRemove"<br/>
:on-error="handleError"</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="6" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22%20%20%20%20handleSuccess(response%2C%20file%2C%20fileList)%20%7B%5Cn%20%20%20%20%20%20this.successMessage(%5C%22%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F%5C%22)%3B%5Cn%20%20%20%20%20%20this.loading%20%3D%20false%3B%5Cn%20%20%20%20%7D%2C%5Cn%5Cn%20%20%20%20handleError(e%2C%20file%2C%20fileList)%20%7B%5Cn%20%20%20%20%20%20this.errorMessage(e)%3B%5Cn%20%20%20%20%20%20this.loading%20%3D%20false%3B%5Cn%20%20%20%20%7D%2C%5Cn%5Cn%20%20%20%20handleRemove(file%2C%20fileList)%20%7B%5Cn%20%20%20%20%20%20if%20(file.raw.cancelToken)%20%7B%5Cn%20%20%20%20%20%20%20%20file.raw.cancelToken.cancel()%3B%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%2C%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-TypeScript hljs">    <span class="hljs-title function_">handleSuccess(<span class="hljs-params">response, file, fileList) {
      <span class="hljs-variable language_">this.<span class="hljs-title function_">successMessage(<span class="hljs-string">"上传成功");
      <span class="hljs-variable language_">this.<span class="hljs-property">loading = <span class="hljs-literal">false;
    },
    <span class="hljs-title function_">handleError(<span class="hljs-params">e, file, fileList) {
      <span class="hljs-variable language_">this.<span class="hljs-title function_">errorMessage(e);
      <span class="hljs-variable language_">this.<span class="hljs-property">loading = <span class="hljs-literal">false;
    },
    <span class="hljs-title function_">handleRemove(<span class="hljs-params">file, fileList) {
      <span class="hljs-keyword">if (file.<span class="hljs-property">raw.<span class="hljs-property">cancelToken) {
        file.<span class="hljs-property">raw.<span class="hljs-property">cancelToken.<span class="hljs-title function_">cancel();
      }
    },</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
</div><p>编写上传队列的Html代码：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="5" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22html%22%2C%22code%22%3A%22%20%20%20%20%20%20%3Cel-button%20ref%3D%5C%22uploadButton%5C%22%3E%E4%B8%8A%E4%BC%A0%3C%2Fel-button%3E%5Cn%20%20%20%20%20%20%3Cspan%20slot%3D%5C%22file%5C%22%20slot-scope%3D%5C%22%7B%20file%20%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%5C%22filelist-item%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cel-row%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cel-col%20%3Aspan%3D%5C%226%5C%22%20class%3D%5C%22file-icon-frame%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ci%20class%3D%5C%22el-icon-document%20file-icon%5C%22%3E%3C%2Fi%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fel-col%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cel-col%20%3Aspan%3D%5C%2218%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cel-row%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cel-col%20%3Aspan%3D%5C%2220%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20class%3D%5C%22file-title%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7B%20file.name%20%7D%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Flabel%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fel-col%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cel-col%20%3Aspan%3D%5C%224%5C%22%20style%3D%5C%22text-align%3A%20right%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cel-button%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%5C%22danger%5C%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20icon%3D%5C%22el-icon-minus%5C%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size%3D%5C%22mini%5C%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20circle%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%40click%3D%5C%22handleRemove(file)%5C%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3E%3C%2Fel-button%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fel-col%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cel-col%20%3Aspan%3D%5C%2224%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20class%3D%5C%22file-size%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7B%20FriendlyFileSize(file.size)%20%7D%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Flabel%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fel-col%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cel-col%20%3Aspan%3D%5C%2224%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cel-progress%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Atext-inside%3D%5C%22true%5C%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Astroke-width%3D%5C%2226%5C%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Apercentage%3D%5C%22parseInt(file.percentage%2C%2010)%5C%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Astatus%3D%5C%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20parseInt(file.percentage%2C%2010)%20%3D%3D%20100%20%3F%20'success'%20%3A%20''%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fel-progress%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3E%3C%2Fel-col%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fel-row%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fel-col%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C%2Fel-row%3E%5Cn%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%3C%2Fspan%3E%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-html hljs">      <span class="hljs-tag">&lt;<span class="hljs-name">el-button <span class="hljs-attr">ref=<span class="hljs-string">"uploadButton"&gt;上传<span class="hljs-tag">&lt;/<span class="hljs-name">el-button&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">span <span class="hljs-attr">slot=<span class="hljs-string">"file" <span class="hljs-attr">slot-scope=<span class="hljs-string">"{ file }"&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">div <span class="hljs-attr">class=<span class="hljs-string">"filelist-item"&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">el-row&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">el-col <span class="hljs-attr">:span=<span class="hljs-string">"6" <span class="hljs-attr">class=<span class="hljs-string">"file-icon-frame"&gt;
              <span class="hljs-tag">&lt;<span class="hljs-name">i <span class="hljs-attr">class=<span class="hljs-string">"el-icon-document file-icon"&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">i&gt;
            <span class="hljs-tag">&lt;/<span class="hljs-name">el-col&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">el-col <span class="hljs-attr">:span=<span class="hljs-string">"18"&gt;
              <span class="hljs-tag">&lt;<span class="hljs-name">el-row&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">el-col <span class="hljs-attr">:span=<span class="hljs-string">"20"&gt;
                  <span class="hljs-tag">&lt;<span class="hljs-name">label <span class="hljs-attr">class=<span class="hljs-string">"file-title"&gt;
                    {{ file.name }}
                  <span class="hljs-tag">&lt;/<span class="hljs-name">label&gt;
                <span class="hljs-tag">&lt;/<span class="hljs-name">el-col&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">el-col <span class="hljs-attr">:span=<span class="hljs-string">"4" <span class="hljs-attr">style=<span class="hljs-string">"text-align: right"&gt;
                  <span class="hljs-tag">&lt;<span class="hljs-name">el-button
                    <span class="hljs-attr">type=<span class="hljs-string">"danger"
                    <span class="hljs-attr">icon=<span class="hljs-string">"el-icon-minus"
                    <span class="hljs-attr">size=<span class="hljs-string">"mini"
                    <span class="hljs-attr">circle
                    @<span class="hljs-attr">click=<span class="hljs-string">"handleRemove(file)"
                  &gt;<span class="hljs-tag">&lt;/<span class="hljs-name">el-button&gt;
                <span class="hljs-tag">&lt;/<span class="hljs-name">el-col&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">el-col <span class="hljs-attr">:span=<span class="hljs-string">"24"&gt;
                  <span class="hljs-tag">&lt;<span class="hljs-name">label <span class="hljs-attr">class=<span class="hljs-string">"file-size"&gt;
                    {{ FriendlyFileSize(file.size) }}
                  <span class="hljs-tag">&lt;/<span class="hljs-name">label&gt;
                <span class="hljs-tag">&lt;/<span class="hljs-name">el-col&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">el-col <span class="hljs-attr">:span=<span class="hljs-string">"24"&gt;
                  <span class="hljs-tag">&lt;<span class="hljs-name">el-progress
                    <span class="hljs-attr">:text-inside=<span class="hljs-string">"true"
                    <span class="hljs-attr">:stroke-width=<span class="hljs-string">"26"
                    <span class="hljs-attr">:percentage=<span class="hljs-string">"parseInt(file.percentage, 10)"
                    <span class="hljs-attr">:status=<span class="hljs-string">"
                      parseInt(file.percentage, 10) == 100 ? 'success' : ''
                    "
                  &gt;
                  &lt;/el-progress
                &gt;<span class="hljs-tag">&lt;/<span class="hljs-name">el-col&gt;
              <span class="hljs-tag">&lt;/<span class="hljs-name">el-row&gt;
            <span class="hljs-tag">&lt;/<span class="hljs-name">el-col&gt;
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-row&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">div&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">span&gt;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
</div><h2>运行</h2><p>进入后端项目的目录(api)，运行：</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="4" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22dotnet%20run%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">dotnet run</code></pre>
</div><p>前端项目目录(web)，运行</p><div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="3" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22yarn%20serve%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">yarn serve</code></pre>
</div><p>运行效果：</p><p> </p><p> <span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="2" data-cke-widget-wrapper="1"><img alt="" class="cke_widget_element" data-cke-saved-src="https://img2023.cnblogs.com/blog/644861/202310/644861-20231022164733211-1454288881.gif" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F3291831ba83e48ca9f2b5d9450f32653.gif%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22%22%2C%22height%22%3A%22%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" src="644861-20231022164733211-1454288881.gif"/></span></p><p> </p><p> </p><p>完整代码：</p><p><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="1" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" data-cke-enter-mode="2" data-cke-saved-href="https://github.com/jevonsflash/file-uploader-sample/tree/master/web" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fgithub.com%2Fjevonsflash%2Ffile-uploader-sample%2Ftree%2Fmaster%2Fweb%22%2C%22text%22%3A%22file-uploader-sample%2Fweb%20at%20master%20%C2%B7%20jevonsflash%2Ffile-uploader-sample%20(github.com)%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM276%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.9%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM3C8%22%2C%22id%22%3A%22BdBBDH-1650438341119%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.0.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M276" data-link-title="file-uploader-sample/web at master · jevonsflash/file-uploader-sample (github.com)" data-widget="csdnlink" href="https://github.com/jevonsflash/file-uploader-sample/tree/master/web" title="file-uploader-sample/web at master · jevonsflash/file-uploader-sample (github.com)">file-uploader-sample/web at master · jevonsflash/file-uploader-sample (github.com)</a></span></p><p>项目地址：</p><p><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="0" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" data-cke-enter-mode="2" data-cke-saved-href="https://github.com/jevonsflash/file-uploader-sample" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fgithub.com%2Fjevonsflash%2Ffile-uploader-sample%22%2C%22text%22%3A%22jevonsflash%2Ffile-uploader-sample%20(github.com)%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM276%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.9%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM3C8%22%2C%22id%22%3A%22UFyVG9-1650438341119%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.0.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M276" data-link-title="jevonsflash/file-uploader-sample (github.com)" data-widget="csdnlink" href="https://github.com/jevonsflash/file-uploader-sample" title="jevonsflash/file-uploader-sample (github.com)">jevonsflash/file-uploader-sample (github.com)</a></span></p><span data-cke-copybin-start="1"><span data-cke-copybin-end="1">​</span></span>