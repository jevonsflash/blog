---
thumbnail:
cover:
title: '[学习笔记]Linux环境下部署 .Net5 程序'
excerpt:
description:
date: 2022-02-10 14:36:00
tags:
  - Linux
  - .net
  - Nginx

categories:
  - .NET
 
toc: true
recommend: 1
keywords: categories-java
uniqueId: 2022-02-10 14:36:00/[学习笔记]Linux环境下部署 .Net5 程序.html
---
<p><span data-cke-copybin-start="1"><span data-cke-copybin-start="1">​</span></span><span id="cke_bm_409S">公司的项目需要部署到一台公网的linux服务器，以便同事们测试小程序。</span></p>
<p>目标服务器是新搭建的CentOS 8虚拟机，以非docker的方式部署。现记录过程便于日后部署至项目甲方的服务器上，因为甲方的服务器可能未联网，或者网络资源有限（公司按流量算钱的WiFi棒）&nbsp;宗旨是尽量用U盘拷贝二进制文件以离线的方式安装</p>
<h3>首先需要准备环境：</h3>
<ol>
<li>&nbsp;.net5 环境<span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="30" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="&nbsp;Download .NET 5.0 (Linux, macOS, and Windows) (microsoft.com)" href="https://dotnet.microsoft.com/en-us/download/dotnet/5.0" data-cke-enter-mode="2" data-cke-saved-href="https://dotnet.microsoft.com/en-us/download/dotnet/5.0" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fdotnet.microsoft.com%2Fen-us%2Fdownload%2Fdotnet%2F5.0%22%2C%22text%22%3A%22%C2%A0Download%20.NET%205.0%20(Linux%2C%20macOS%2C%20and%20Windows)%20(microsoft.com)%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22id%22%3A%22bsTpEK-1644474865701%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release1.9.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M0H8" data-link-title="&nbsp;Download .NET 5.0 (Linux, macOS, and Windows) (microsoft.com)" data-widget="csdnlink">&nbsp;Download .NET 5.0 (Linux, macOS, and Windows) (microsoft.com)</a>下载SDK X64就好</span></li>
<li>&nbsp;Microsoft SQL Server 14 数据库<span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="29" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="Index of /rhel/7/mssql-server-2017/ (microsoft.com)" href="https://packages.microsoft.com/rhel/7/mssql-server-2017/" data-cke-enter-mode="2" data-cke-saved-href="https://packages.microsoft.com/rhel/7/mssql-server-2017/" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fpackages.microsoft.com%2Frhel%2F7%2Fmssql-server-2017%2F%22%2C%22text%22%3A%22Index%20of%20%2Frhel%2F7%2Fmssql-server-2017%2F%20(microsoft.com)%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22id%22%3A%22MNvv1W-1644474865700%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release1.9.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M0H8" data-link-title="Index of /rhel/7/mssql-server-2017/ (microsoft.com)" data-widget="csdnlink">Index of /rhel/7/mssql-server-2017/ (microsoft.com)</a></span></li>
<li>&nbsp;Node-v16.13.0<span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="28" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="下载 | Node.js (nodejs.org)" href="https://nodejs.org/zh-cn/download/" data-cke-enter-mode="2" data-cke-saved-href="https://nodejs.org/zh-cn/download/" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fnodejs.org%2Fzh-cn%2Fdownload%2F%22%2C%22text%22%3A%22%E4%B8%8B%E8%BD%BD%20%7C%20Node.js%20(nodejs.org)%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22id%22%3A%229kS6pb-1644474865699%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release1.9.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M0H8" data-link-title="下载 | Node.js (nodejs.org)" data-widget="csdnlink">下载 | Node.js (nodejs.org)</a></span></li>
<li>&nbsp;以及一些服务，比如RocketChat或者Nginx</li>
</ol>
<p>使用github或者gitee创建代码仓库，用于迁移代码至测试服务器，如果公司的git和代码仓库需要同时更新，可以依据下面文章进行设置：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_wrapper_has-card cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="27" data-cke-widget-wrapper="1"><a class="has-card cke_widget_editable cke_widget_element" title="如何同步多个 git 远程仓库 - taadis - 博客园 (cnblogs.com)" href="https://www.cnblogs.com/taadis/p/12170953.html" data-cke-enter-mode="2" data-cke-saved-href="https://www.cnblogs.com/taadis/p/12170953.html" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fwww.cnblogs.com%2Ftaadis%2Fp%2F12170953.html%22%2C%22text%22%3A%22%E5%A6%82%E4%BD%95%E5%90%8C%E6%AD%A5%E5%A4%9A%E4%B8%AA%20git%20%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%20-%20taadis%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD%20(cnblogs.com)%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22isCard%22%3Atrue%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22id%22%3A%22NmpxJ8-1644474865689%22%2C%22classes%22%3A%7B%22has-card%22%3A1%7D%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release1.9.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M0H8" data-link-title="如何同步多个 git 远程仓库 - taadis - 博客园 (cnblogs.com)" data-widget="csdnlink"><span class="link-card-box"><span class="link-title">如何同步多个 git 远程仓库 - taadis - 博客园 (cnblogs.com)</span></span></a></span></p>
<h3><span data-cke-copybin-start="1"><span data-cke-copybin-start="1">​</span></span></h3>
<h3>调整项目源代码</h3>
<p>各项安装好之后，新建一个解决方案专用的文件夹，git clone代码至文件夹内</p>
<p>并打开解决方案的WebHost项目目录，并键入dotnet build测试编译情况</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="201" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/e42f0b4ba8b4443cb2c91e98b75aeac5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="925" height="462" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/e42f0b4ba8b4443cb2c91e98b75aeac5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fe42f0b4ba8b4443cb2c91e98b75aeac5.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22925%22%2C%22height%22%3A%22462%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202203/644861-20220314115719022-2066590539.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>处理一下错误，以我为例：</p>
<p><strong>修改Linux的文件编码：</strong></p>
<p>比如我在Windows下编写的一些代码文件会以GB2312的编码保存，则Linux下会出现乱码，更改后编译通过。</p>
<p><strong>添加兼容库</strong></p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="200" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/f74770b1825f42debbb25963540223cc.png" alt="" width="263" height="78" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/f74770b1825f42debbb25963540223cc.png" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Ff74770b1825f42debbb25963540223cc.png%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22263%22%2C%22height%22%3A%2278%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202203/644861-20220314115719022-2066590539.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>如果在项目中用到System.Drawing库，默认在Linux上是不支持的，需要安装Windows Compatibility Pack兼容包解决</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="199" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22%22%2C%22code%22%3A%22dotnet%20add%20package%20Microsoft.Windows.Compatibility%20--version%205.0.2%22%7D" data-cke-widget-keep-attr="0" data-widget="codeSnippet"><code class="hljs">dotnet add package Microsoft.Windows.Compatibility --version 5.0.2</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202203/644861-20220314115719022-2066590539.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
<p>注意不要安装6.0.0以上的版本，否则会报以下错误：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="198" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/40337215641e4846bddf557782c11123.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="906" height="95" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/40337215641e4846bddf557782c11123.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F40337215641e4846bddf557782c11123.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22906%22%2C%22height%22%3A%2295%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202203/644861-20220314115719022-2066590539.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>这是因为微软从.net6.0开始已经不再支持System.Drawing库的Linux平台兼容性了 ，微软希望你用功能更加丰富的Microsoft.Maui.Graphics包来代替System.Drawing</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="197" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="中断性变更：仅在 Windows 上支持 System.Drawing.Common - .NET | Microsoft Docs" href="https://docs.microsoft.com/zh-cn/dotnet/core/compatibility/core-libraries/6.0/system-drawing-common-windows-only" data-cke-enter-mode="2" data-cke-saved-href="https://docs.microsoft.com/zh-cn/dotnet/core/compatibility/core-libraries/6.0/system-drawing-common-windows-only" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fdotnet%2Fcore%2Fcompatibility%2Fcore-libraries%2F6.0%2Fsystem-drawing-common-windows-only%22%2C%22text%22%3A%22%E4%B8%AD%E6%96%AD%E6%80%A7%E5%8F%98%E6%9B%B4%EF%BC%9A%E4%BB%85%E5%9C%A8%20Windows%20%E4%B8%8A%E6%94%AF%E6%8C%81%20System.Drawing.Common%20-%20.NET%20%7C%20Microsoft%20Docs%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM276%22%2C%22id%22%3A%22eyPYBo-1647229427499%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.0.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M276" data-link-title="中断性变更：仅在 Windows 上支持 System.Drawing.Common - .NET | Microsoft Docs" data-widget="csdnlink">中断性变更：仅在 Windows 上支持 System.Drawing.Common - .NET | Microsoft Docs</a></span></p>
<p><strong>​​​​​​​在CentOS中添加图片处理程序</strong></p>
<p>参考这篇文章安装libgdiplus：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="196" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="07、 centos7.7 安装libgdiplus - 简书 (jianshu.com)" href="https://www.jianshu.com/p/f71f9e7138c0" data-cke-enter-mode="2" data-cke-saved-href="https://www.jianshu.com/p/f71f9e7138c0" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fwww.jianshu.com%2Fp%2Ff71f9e7138c0%22%2C%22text%22%3A%2207%E3%80%81%20centos7.7%20%E5%AE%89%E8%A3%85libgdiplus%20-%20%E7%AE%80%E4%B9%A6%20(jianshu.com)%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.0.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM276%22%2C%22id%22%3A%22hc9GxX-1647229999206%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.0.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M276" data-link-title="07、 centos7.7 安装libgdiplus - 简书 (jianshu.com)" data-widget="csdnlink">07、 centos7.7 安装libgdiplus - 简书 (jianshu.com)</a></span></p>
<p>在安装完成后需要在/usr/lib64中生成二进制链接文件：</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="206" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22%22%2C%22code%22%3A%22cd%20%2Fusr%2Flib64%5Cnsudo%20ln%20-s%20%20%2Fusr%2Flocal%2Flibgdiplus-6.0.5%2Fsbin%2Flib%2Flibgdiplus.so.0.0.0%20libgdiplus.so%5Cn%22%7D" data-cke-widget-keep-attr="0" data-widget="codeSnippet"><code class="hljs">cd /usr/lib64
sudo ln -s  /usr/local/libgdiplus-6.0.5/sbin/lib/libgdiplus.so.0.0.0 libgdiplus.so
</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202203/644861-20220314115719022-2066590539.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
<p><strong>处理inotify报错：</strong></p>
<p>在Configuration读取的时候用了reloadOnChange为True：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="195" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/19e3b05bc3ba4deaadc879e91ed2f85e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="609" height="55" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/19e3b05bc3ba4deaadc879e91ed2f85e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F19e3b05bc3ba4deaadc879e91ed2f85e.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22609%22%2C%22height%22%3A%2255%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202203/644861-20220314115719022-2066590539.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>那么linux在使用inotify 文件系统的变化通知机制时就会报错超过使用上限的错误：</p>
<blockquote>
<p>---&gt; System.IO.IOException: The configured user limit (128) on the number of inotify instances has been reached, or the per-process limit on the number of open file descriptors has been reached&nbsp;</p>
</blockquote>
<p>&nbsp;</p>
<p><strong>SQL server 的集成验证方式修改：</strong></p>
<p>linux下的SQL server不支持集成验证方式登录，将连接字符串的&nbsp;integrated security改为false;并且在后面提供用户名及密码：</p>
<p>User ID=YourProperUserName;Password=YourProperUserPassword;</p>
<p>&nbsp;</p>
<h3>配置数据库</h3>
<p>bash中键入sudo /opt/mssql/bin/mssql-conf setup以启动配置脚本，在一些列配置完成后，输入systemctl status mssql-server以确认SQL server启动成功</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="24" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/135a0ed3efd349ad96fc8d24f011d6db.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="780" height="104" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/135a0ed3efd349ad96fc8d24f011d6db.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F135a0ed3efd349ad96fc8d24f011d6db.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22780%22%2C%22height%22%3A%22104%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>如果没有成功，需要手动运行systemctl start mssql-server启动服务，运行systemctl enable mssql-server保证开机时能自动启动</p>
<p>安装sql-tool工具:</p>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="23" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22curl%20https%3A%2F%2Fpackages.microsoft.com%2Fconfig%2Frhel%2F8%2Fprod.repo%20%3E%20%2Fetc%2Fyum.repos.d%2Fmsprod.repo%5Cnsudo%20yum%20install%20-y%20mssql-tools%20unixODBC-devel%5Cnecho%20'export%20PATH%3D%5C%22%24PATH%3A%2Fopt%2Fmssql-tools%2Fbin%5C%22'%20%3E%3E%20~%2F.bash_profile%5Cnecho%20'export%20PATH%3D%5C%22%24PATH%3A%2Fopt%2Fmssql-tools%2Fbin%5C%22'%20%3E%3E%20~%2F.bashrc%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">curl https://packages.microsoft.com/config/rhel/8/prod.repo &gt; /etc/yum.repos.d/msprod.repo
sudo yum install -y mssql-tools unixODBC-devel
echo 'export PATH="$PATH:/opt/mssql-tools/bin"' &gt;&gt; ~/.bash_profile
echo 'export PATH="$PATH:/opt/mssql-tools/bin"' &gt;&gt; ~/.bashrc</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<p>验证安装是否成功</p>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="22" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22sqlcmd%20-S%20localhost%20-U%20SA%20-P%20'%3C%E4%BD%A0%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%86%E7%A0%81%3E'%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">sqlcmd -S localhost -U SA -P '&lt;你的数据库密码&gt;'</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<p>如果显示&gt;1表示链接成功</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="21" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/30fd218f651246efbcc559fa7c2d1a2a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="572" height="32" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/30fd218f651246efbcc559fa7c2d1a2a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F30fd218f651246efbcc559fa7c2d1a2a.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22572%22%2C%22height%22%3A%2232%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>[可选]建议修改管理员登录密码</p>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="20" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22sqlcmd%20-U%20sa%20-P%20oldpassword%20-Z%20newpassword%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">sqlcmd -U sa -P oldpassword -Z newpassword</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<p>&nbsp;[可选]如果在宿主机上使用数据库管理工具，则需要打开1433端口，以便外部访问</p>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="19" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22bash%22%2C%22code%22%3A%22firewall-cmd%20--zone%3Dpublic%20--add-port%3D1433%2Ftcp%20--permanent%5Cn%5Cnfirewall-cmd%20--reload%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-bash hljs">firewall-cmd --zone=public --add-port=1433/tcp --permanent

firewall-cmd --reload</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<h3>运行数据库迁移</h3>
<p>回到解决方案目录的Miguration项目目录中运行迁移，如下运行成功</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="18" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/8ac55668b1064e85bb9601981029d253.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="903" height="146" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/8ac55668b1064e85bb9601981029d253.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F8ac55668b1064e85bb9601981029d253.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22903%22%2C%22height%22%3A%22146%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>运行完迁移，回到Web.Host项目中运行dotnet run。如下运行成功</p>
<p>&nbsp;<span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="17" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/d242ecd1a48f481c855a9632092a7fef.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="604" height="34" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/d242ecd1a48f481c855a9632092a7fef.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fd242ecd1a48f481c855a9632092a7fef.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22604%22%2C%22height%22%3A%2234%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<h3>&nbsp;</h3>
<h3>&nbsp;配置网络<strong>　</strong>　</h3>
<p>首先来配置Nginx，打开配置文件：etc/nginx/nginx.conf，修改配置为：<span data-cke-copybin-start="1"><span data-cke-copybin-start="1">​</span></span></p>
<p><span id="cke_bm_1671S">&nbsp;.Net5 程序部分</span></p>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="17" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22server%20%7B%5Cn%20%20%20%20listen%20%20%20%20%20%20%20%203100%20ssl%20http2%3B%5Cn%20%20%20%20server_name%20%20%20example.com%20*.example.com%3B%5Cn%20%20%20%20root%20%20%20%20%20%20%20%20%20%2Fusr%2Fshare%2Fnginx%2Fhtml%3B%5Cn%20%20%20%20%20%5Cn%5Ct...%5Cn%5Ct%5Cn%5Ct%5Cn%5Ct%5Cn%20%20%20%20location%20%2Fapi%20%7B%5Cn%20%20%20%20%20%20%20%20proxy_pass%20%20%20%20%20%20%20%20%20http%3A%2F%2F127.0.0.1%3A21021%2Fapi%3B%5Cn%20%20%20%20%20%20%20%20proxy_http_version%201.1%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Upgrade%20%24http_upgrade%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Connection%20keep-alive%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Host%20%24host%3B%5Cn%20%20%20%20%20%20%20%20proxy_cache_bypass%20%24http_upgrade%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20X-Forwarded-For%20%24proxy_add_x_forwarded_for%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20X-Forwarded-Proto%20%24scheme%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20location%20%2Fsignalr%20%7B%5Cn%20%20%20%20%20%20%20%20proxy_pass%20%20%20%20%20%20%20%20%20http%3A%2F%2F127.0.0.1%3A21021%2Fsignalr%3B%5Cn%20%20%20%20%20%20%20%20proxy_http_version%201.1%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Upgrade%20%24http_upgrade%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Connection%20keep-alive%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Connection%20%5C%22upgrade%5C%22%3B%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Host%20%24host%3B%5Cn%20%20%20%20%20%20%20%20proxy_cache_bypass%20%24http_upgrade%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20X-Forwarded-For%20%24proxy_add_x_forwarded_for%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20X-Forwarded-Proto%20%24scheme%3B%5Cn%20%20%20%20%7D%5Cn%7D%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">server {
    listen        3100 ssl http2;
    server_name   example.com *.example.com;
    root         /usr/share/nginx/html;
     
	...
	
	
	
    location /api {
        proxy_pass         http://127.0.0.1:21021/api;
        proxy_http_version 1.1;
        proxy_set_header   Upgrade $http_upgrade;
        proxy_set_header   Connection keep-alive;
        proxy_set_header   Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
    }
    
   location /signalr {
        proxy_pass         http://127.0.0.1:21021/signalr;
        proxy_http_version 1.1;
        proxy_set_header   Upgrade $http_upgrade;
        proxy_set_header   Connection keep-alive;
        proxy_set_header   Connection "upgrade";        
        proxy_set_header   Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
    }
}</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220215094559114-1550550909.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<p>RocketChat部分:</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="16" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22%20server%20%7B%5Cn%20%20%20%20listen%20%20%20%20%20%20%20%202900%20ssl%20http2%3B%5Cn%20%20%20%20server_name%20%20%20example2.com%20*.example2.com%3B%5Cn%20%20%20%20root%20%20%20%20%20%20%20%20%20%2Fusr%2Fshare%2Fnginx%2Fhtml%3B%5Cn%20%20%20%20%5Cn%20%20%20%20...%5Cn%20%20%20%20%20%5Cn%20%20%20%20location%20%2F%20%7B%5Cn%20%20%20%20%20%20%20%20proxy_pass%20%20%20%20%20%20%20%20%20http%3A%2F%2F127.0.0.1%3A3000%3B%5Cn%20%20%20%20%20%20%20%20proxy_http_version%201.1%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Upgrade%20%24http_upgrade%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Connection%20keep-alive%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Connection%20%5C%22upgrade%5C%22%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20Host%20%24host%3B%5Cn%20%20%20%20%20%20%20%20proxy_cache_bypass%20%24http_upgrade%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20X-Forwarded-For%20%24proxy_add_x_forwarded_for%3B%5Cn%20%20%20%20%20%20%20%20proxy_set_header%20%20%20X-Forwarded-Proto%20%24scheme%3B%5Cn%20%20%20%20%7D%5Cn%7D%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs"> server {
    listen        2900 ssl http2;
    server_name   example2.com *.example2.com;
    root         /usr/share/nginx/html;
    
    ...
     
    location / {
        proxy_pass         http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header   Upgrade $http_upgrade;
        proxy_set_header   Connection keep-alive;
        proxy_set_header   Connection "upgrade";
        proxy_set_header   Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
    }
}</code></pre>
</div>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="16" data-cke-widget-wrapper="1"><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<p>然后运行重新加载命令&nbsp;</p>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="15" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22nginx%20-s%20reload%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">nginx -s reload</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<p>宿主机的浏览器打开<span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="14" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="http://192.168.137.101:3100/" href="http://192.168.137.101:3100/" data-cke-enter-mode="2" data-cke-saved-href="http://192.168.137.101:3100/" data-cke-widget-data="%7B%22url%22%3A%22http%3A%2F%2F192.168.137.101%3A3100%2F%22%2C%22text%22%3A%22http%3A%2F%2F192.168.137.101%3A3100%2F%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22id%22%3A%22z9MzWM-1644474865675%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release1.9.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M0H8" data-link-title="http://192.168.137.101:3100/" data-widget="csdnlink">http://192.168.137.101:3100/</a><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="13" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="192.168.137.101" href="http://192.168.137.101:3100/" data-cke-enter-mode="2" data-cke-saved-href="http://192.168.137.101:3100/" data-cke-widget-data="%7B%22url%22%3A%22http%3A%2F%2F192.168.137.101%3A3100%2F%22%2C%22text%22%3A%22192.168.137.101%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22id%22%3A%22z1Atm8-1644474865674%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release1.9.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M0H8" data-link-title="192.168.137.101" data-widget="csdnlink">192.168.137.101</a>来测试代理是否畅通，如果无法链接（ERR_CONNECTION_REFUSED）或者出现502（Bad Gateway）错误，则需要对网络配置进行排查:</span></span></p>
<p>1. 安装nmap查看对外端口开放情况：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="12" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/d6afb45f6c864d7dadf55193e69640ba.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="607" height="220" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/d6afb45f6c864d7dadf55193e69640ba.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fd6afb45f6c864d7dadf55193e69640ba.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22607%22%2C%22height%22%3A%22220%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​​</span></span></span></p>
<p>2. 查看nginx错误日志&nbsp;</p>
<p>&nbsp;<span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="11" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/b644229c04b5461ab2cc2a905d50a79d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="897" height="155" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/b644229c04b5461ab2cc2a905d50a79d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fb644229c04b5461ab2cc2a905d50a79d.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22897%22%2C%22height%22%3A%22155%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​​</span></span></span></p>
<p>比如我的情况是没有权限，则参考此方案解决</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_wrapper_has-card cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="10" data-cke-widget-wrapper="1"><a class="has-card cke_widget_editable cke_widget_element" title="django - (13: Permission denied) while connecting to upstream:[nginx] - Stack Overflow" href="https://stackoverflow.com/questions/23948527/13-permission-denied-while-connecting-to-upstreamnginx" data-cke-enter-mode="2" data-cke-saved-href="https://stackoverflow.com/questions/23948527/13-permission-denied-while-connecting-to-upstreamnginx" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fstackoverflow.com%2Fquestions%2F23948527%2F13-permission-denied-while-connecting-to-upstreamnginx%22%2C%22text%22%3A%22django%20-%20(13%3A%20Permission%20denied)%20while%20connecting%20to%20upstream%3A%5Bnginx%5D%20-%20Stack%20Overflow%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22isCard%22%3Atrue%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22id%22%3A%22aRbjKe-1644474865664%22%2C%22classes%22%3A%7B%22has-card%22%3A1%7D%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release1.9.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M0H8" data-link-title="django - (13: Permission denied) while connecting to upstream:[nginx] - Stack Overflow" data-widget="csdnlink"><span class="link-card-box"><span class="link-title">django - (13: Permission denied) while connecting to upstream:[nginx] - Stack Overflow</span></span></a></span></p>
<p>我们更改了监听端口到3100，则因为Centos的安全策略可能会出现&nbsp;[emerg] bind() to 0.0.0.0:XXXX failed (13: Permission denied)的报错，则运行如下命令将3100添加至http的端口配置:</p>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="9" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22sudo%20semanage%20port%20-a%20-t%20http_port_t%20%20-p%20tcp%203100%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">sudo semanage port -a -t http_port_t  -p tcp 3100</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<p>添加完成后运行 ，观察到端口3100已经添加完成</p>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="8" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22semanage%20port%20-l%20%7C%20grep%20http_port_t%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">semanage port -l | grep http_port_t</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="7" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/5d5a54c97a9d4a3fb6ca6c83c7a191cf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="715" height="49" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/5d5a54c97a9d4a3fb6ca6c83c7a191cf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F5d5a54c97a9d4a3fb6ca6c83c7a191cf.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22715%22%2C%22height%22%3A%2249%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​​&nbsp;</span></span></span></p>
<p>再次在宿主机的浏览器打开<span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="6" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="http://192.168.137.101:3100/" href="http://192.168.137.101:3100/" data-cke-enter-mode="2" data-cke-saved-href="http://192.168.137.101:3100/" data-cke-widget-data="%7B%22url%22%3A%22http%3A%2F%2F192.168.137.101%3A3100%2F%22%2C%22text%22%3A%22http%3A%2F%2F192.168.137.101%3A3100%2F%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22id%22%3A%22NLujBl-1644474865661%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release1.9.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M0H8" data-link-title="http://192.168.137.101:3100/" data-widget="csdnlink">http://192.168.137.101:3100/</a><span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="5" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="192.168.137.101" href="http://192.168.137.101:3100/" data-cke-enter-mode="2" data-cke-saved-href="http://192.168.137.101:3100/" data-cke-widget-data="%7B%22url%22%3A%22http%3A%2F%2F192.168.137.101%3A3100%2F%22%2C%22text%22%3A%22192.168.137.101%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease1.9.8%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DM0H8%22%2C%22id%22%3A%22KpkUdb-1644474865660%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release1.9.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M0H8" data-link-title="192.168.137.101" data-widget="csdnlink">192.168.137.101</a>来测试代理是否畅通</span></span></p>
<p>查看到主页已经顺利打开</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="4" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/3f8893d890e048f0a32ee4862a549ac8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="761" height="421" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/3f8893d890e048f0a32ee4862a549ac8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F3f8893d890e048f0a32ee4862a549ac8.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22761%22%2C%22height%22%3A%22421%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​​</span></span></span></p>
<h3>配置宿主机网络</h3>
<p>若要在公网上顺利访问，则需要配置宿主机的网络</p>
<p>之后在宿主机将这个端口号添加至端口转发规则：</p>
<div>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="3" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22netsh%20interface%20portproxy%20add%20v4tov4%20listenaddress%3D127.0.0.1%20listenport%3D3100%20connectaddress%3D192.168.137.1%20connectport%3D3100%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">netsh interface portproxy add v4tov4 listenaddress=127.0.0.1 listenport=3100 connectaddress=192.168.137.1 connectport=3100</code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /></span></div>
</div>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="2" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/760346b255e344eb85af5f5f4739bdda.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="794" height="340" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/760346b255e344eb85af5f5f4739bdda.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F760346b255e344eb85af5f5f4739bdda.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22794%22%2C%22height%22%3A%22340%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​​</span></span></span></p>
<p>&nbsp;在宿主机的防火墙设置中，将3100端口添加到入站和出站规则</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="1" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/e073c0a2822d458d9d5c7abfeafab7c3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_17,color_FFFFFF,t_70,g_se,x_16" alt="" width="431" height="568" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/e073c0a2822d458d9d5c7abfeafab7c3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_17,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2Fe073c0a2822d458d9d5c7abfeafab7c3.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_17%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22431%22%2C%22height%22%3A%22568%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>&nbsp;在任意终端访问我的阿里云域名，可以访问到接口，至此所有部署工作已结束！</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="图像" data-cke-filter="off" data-cke-widget-id="0" data-cke-widget-wrapper="1"><img src="https://img-blog.csdnimg.cn/01be9bbfcfc84d50934f688105c30e14.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="" width="687" height="491" class="cke_widget_element" data-cke-saved-src="https://img-blog.csdnimg.cn/01be9bbfcfc84d50934f688105c30e14.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5p6X5pmTbHg=,size_20,color_FFFFFF,t_70,g_se,x_16" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fimg-blog.csdnimg.cn%2F01be9bbfcfc84d50934f688105c30e14.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA5p6X5pmTbHg%3D%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%22687%22%2C%22height%22%3A%22491%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2022.cnblogs.com/blog/644861/202202/644861-20220210143621513-1752257196.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p><br />
</p>
<p>
<span data-cke-copybin-start="1">
<span data-cke-copybin-end="1">​</span></span></p>